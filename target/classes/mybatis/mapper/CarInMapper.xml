<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.auc.mapper.CarInMapper">

    <!--  根据车牌号查询白名单用户表  -->
    <select id="findWhite" parameterType="java.lang.String" resultType="com.auc.pojo.White">
        select white_id,white_name,white_account,white_password,white_carnumber,white_phone,white_createtime,worker_id from t_white where white_carnumber=#{whiteCarnumber}
    </select>

    <!--  根据车牌号查询月缴用户表  -->
    <select id="findVip" parameterType="java.lang.String" resultType="com.auc.pojo.Vip">
         SELECT vip_id,vip_name,vip_account,vip_password,vip_carnumber,vip_sex,vip_age,vip_phone,vip_address,vip_recharge,vip_score,produce_id,vip_startime,vip_endtime,worker_id from t_vip where vip_carnumber=#{vipCarnumber}
    </select>

    <!--  添加至免检用户表  -->
    <insert id="insertExemption" parameterType="com.auc.pojo.Exemption">
         insert into t_exemption(exemption_name,exemption_carnumber,exemption_paytime) VALUES(#{exemptionName},#{exemptionCarnumber},#{exemptionPaytime})
    </insert>

    <!--  查询停车场车位表  -->
    <select id="findCarPortList" resultType="com.auc.pojo.CarPort">
         SELECT carport_id,carport_number,carport_area,carport_carnumber,carport_photo,carport_starttime,carport_state from t_carport
    </select>

    <!--  修改停车车位表  -->
    <update id="updateCarPort" parameterType="com.auc.pojo.CarPort">
          update t_carport set carport_carnumber=#{carportCarnumber},carport_photo=#{carportPhoto} where carport_id = #{carportId}
    </update>

    <!--  插入历史汇总表  -->
    <insert id="insertHistory" parameterType="com.auc.pojo.History">
          INSERT into t_histor(histor_carnumber,histor_photo) VALUES(#{historCarnumber},#{historPhoto})
    </insert>

    <!--  查询欢迎信息  -->
    <select id="findWelcomeMsg" resultType="java.lang.String">
         select param_name from t_param where param_type='welcomeMsg' and param_value=1001
    </select>

    <!--  根据车牌查询停车位  -->
    <select id="findCarPort" resultType="com.auc.pojo.CarPort">
         SELECT carport_id,carport_number,carport_area,carport_carnumber,carport_photo,carport_starttime,carport_state from t_carport where carport_carnumber=#{carNumber}
    </select>

    <!--  根据车牌查询免检名单表  -->
    <select id="findExemption" parameterType="java.lang.String" resultType="com.auc.pojo.Exemption">
         select exemption_id,exemption_name,exemption_carnumber,exemption_paytime from t_exemption where exemption_carnumber=#{carNumber}
    </select>

    <!--  查询停车时长(分)  -->
    <select id="findTime" resultType="java.lang.Integer">
         SELECT TIMESTAMPDIFF(MINUTE,carport_starttime,#{nowDate}) from t_carport where carport_carnumber=#{carNumber}
    </select>

    <!--  查询收费规则  -->
    <select id="findCostRules" resultType="com.auc.pojo.Costrules">
         select costrules_id,costrules_name,costrules_min,costrules_max,costrules_basemoney,costrules_addmoney,costrules_describe,costrules_state from t_costrules where costrules_state=3
    </select>

</mapper>